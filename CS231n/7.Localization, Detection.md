# Computer Vision Tasks

<p align="center"><img src="https://github.com/em-1001/AI/assets/80628552/30b6bccc-633a-4d16-b70b-01da3ad1ddc2" height="80%" width="80%"></p>

Detection 부터는 여러 object가 있고 각각의 object를 찾아낸다. Segmentation은 각 object를 형상대로 구분하게 된다. 

## Classification + Localization 
Classification같은 경우 C개의 class가 있을 때 input으로 이미지를 받고 output으로 class label을 준다. 평가 지표는 정확도가 된다. 
Localization은 input으로 이미지가 들어오면 output은 label이 아니라 box이다. x, y 좌표 기준 width, height 이렇게 4개의 값(x, y, w, h)을 output으로 준다. 평가 지표는 Intersection Over Union(IOU)로 box와 object가 겹치는 비율이다. 

따라서 결국 Classification과 Localization을 통합하면 label과 box 위치 정보 모두 얻게 되는 것이다. 
Localization에는 크게 2가지 방법이 있다. 

### Idea #1 : Localization as Regression

<p align="center"><img src="https://github.com/em-1001/AI/assets/80628552/1a9b23b1-7ed2-412f-9308-7e32fda09763" height="80%" width="80%"></p>

첫 번째 방법은 Localization을 Regression으로 간주하는 것이다. 이 방법은 1개 또는 n개의 object를 Localization할 때 굳이 detection을 사용하지 않아도 된다. 방법은 위 사진처럼 이미지를 넣고 결과로 4개 수로 이루어진 좌표와 실제 정답 box 좌표를 비교해서 loss를 구하게 된다. 그리고 이 값을 역전파에서 update해서 학습하는 방식이다. 단계별로 보면 아래와 같다. 

#### Step 1 : Train (or download) a classification model (AlexNet, VGG, GoogleNet)  

#### Step 2 : Attach new fully-connected "regression head" to the network

<p align="center"><img src="https://github.com/em-1001/AI/assets/80628552/8f0acc9d-cf79-4bbd-a59f-53de9d59b680" height="70%" width="70%"></p>

위 사진 처럼 결과물이 box의 좌표로 오도록 하는 regression head가 추가되었다. 

#### Step 3 : Train the regression head only with SGD and L2 loss
3 단계에서는 추가된 regression head부분에 대해서만 학습을 시켜준다. 

#### Step 4 : At test time use both heads 
마지막 4 단계에서는 Classification head와 regression head 모두를 이용해서 결과를 산출한다. 


### Per-class vs class agnostic regression
regression head에는 2가지 방법이 있다. Per-class의 경우는 class에 특화된 방법이고, class agnostic은 각각의 class와 무관하게 범용적인 방법이라 할 수 있다. class agnostic의 경우 class에 특화되지 않기 때문에 결과로 그냥 하나의 box 4개의 숫자만 나오게 되고, class에 특화된 class specific한 방법은 각 클래스당 한 box로 결과가 나와 총 `4 X C` class의 수에 4를 곱한 숫자가 나오게 된다.
이 두가지 방법은 loss를 구하는데 약간의 차이가 있을 뿐 유사한 방법이다. 

regression head를 적용해야하는 위치 또한 2가지 방법이 있는데 이 2가지 방법 모두 통한다. 

<p align="center"><img src="https://github.com/em-1001/AI/assets/80628552/aea1db1c-67c0-4cc5-a649-65601d3d1372" height="80%" width="80%"></p>

첫 번째 방법으로는 마지막 conv layer 뒤에다 붙여주는 방식으로 Overfeat이나 VGG를 사용하는 경우 이 방법을 사용하고, FC layer 뒷 단에 붙여주는 경우도 있다. DeepPose나 R-CNN의 경우 이 방법을 사용하고 어떤 경우든 다 잘 동작한다.  

결론적으로 object의 수가 정해진 경우에는 regression만으로도 잘 동작하게 된다. 이럴 때는 굳이 detection을 쓰지 않아도 된다. 


### Idea #2 : Sliding Window 


# Reference
https://www.youtube.com/watch?v=y1dBz6QPxBc&list=PL1Kb3QTCLIVtyOuMgyVgT-OeW0PYXl3j5&index=7  
